namespace Model

module ModelData = 

    let update (x : array<double>) : array<double> = 
        [|
            // Food FoodSubst
            [|
                -1.0 * x.[0] // [(Food FoodSubst, 1)]
                -1.0 * x.[0] // [(Food FoodSubst, 1)]
                -1.0 * x.[0] * x.[3] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[0] * x.[6] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[0] * x.[4] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[0] * x.[5] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[0] * x.[5] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[0] * x.[4] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[0] * x.[6] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[0] * x.[3] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                2.0 * 1.0 * x.[1] * x.[1] // [(Chiral (L A01), 1); (Chiral (L A01), 1)]
                2.0 * 1.0 * x.[2] * x.[2] // [(Chiral (R A01), 1); (Chiral (R A01), 1)]
                2.0 * 1.0 * x.[1] * x.[2] // [(Chiral (L A01), 1); (Chiral (R A01), 1)]
                2.0 * 1.0 * x.[2] * x.[1] // [(Chiral (R A01), 1); (Chiral (L A01), 1)]
                3.0 * 1.0 * x.[1] * x.[3] // [(Chiral (L A01), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                3.0 * 1.0 * x.[2] * x.[6] // [(Chiral (R A01), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                3.0 * 1.0 * x.[1] * x.[4] // [(Chiral (L A01), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                3.0 * 1.0 * x.[2] * x.[5] // [(Chiral (R A01), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                3.0 * 1.0 * x.[1] * x.[5] // [(Chiral (L A01), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                3.0 * 1.0 * x.[2] * x.[4] // [(Chiral (R A01), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                3.0 * 1.0 * x.[1] * x.[6] // [(Chiral (L A01), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                3.0 * 1.0 * x.[2] * x.[3] // [(Chiral (R A01), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                4.0 * 1.0 * x.[3] * x.[3] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                4.0 * 1.0 * x.[6] * x.[6] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                4.0 * 1.0 * x.[3] * x.[4] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                4.0 * 1.0 * x.[6] * x.[5] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                4.0 * 1.0 * x.[3] * x.[5] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                4.0 * 1.0 * x.[6] * x.[4] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                4.0 * 1.0 * x.[3] * x.[6] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                4.0 * 1.0 * x.[6] * x.[3] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                4.0 * 1.0 * x.[4] * x.[4] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                4.0 * 1.0 * x.[5] * x.[5] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                4.0 * 1.0 * x.[4] * x.[5] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                4.0 * 1.0 * x.[5] * x.[4] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                4.0 * 1.0 * x.[4] * x.[6] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                4.0 * 1.0 * x.[5] * x.[3] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
            |]
            |> Array.fold (fun acc r -> acc + r) 0.0

            // Chiral (L A01)
            [|
                1.0 * x.[0] // [(Food FoodSubst, 1)]
                1.0 * x.[0] * x.[3] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                1.0 * x.[0] * x.[4] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                1.0 * x.[0] * x.[5] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                1.0 * x.[0] * x.[6] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[1] * x.[1] // [(Chiral (L A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[1] * x.[1] // [(Chiral (L A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[1] * x.[2] // [(Chiral (L A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[2] * x.[1] // [(Chiral (R A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[1] * x.[1] // [(Chiral (L A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[1] * x.[1] // [(Chiral (L A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[1] * x.[2] // [(Chiral (L A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[2] * x.[1] // [(Chiral (R A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[1] * x.[3] // [(Chiral (L A01), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[1] * x.[4] // [(Chiral (L A01), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[1] * x.[5] // [(Chiral (L A01), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[1] * x.[6] // [(Chiral (L A01), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
            |]
            |> Array.fold (fun acc r -> acc + r) 0.0

            // Chiral (R A01)
            [|
                1.0 * x.[0] // [(Food FoodSubst, 1)]
                1.0 * x.[0] * x.[6] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                1.0 * x.[0] * x.[5] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                1.0 * x.[0] * x.[4] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                1.0 * x.[0] * x.[3] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[2] * x.[2] // [(Chiral (R A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[2] * x.[2] // [(Chiral (R A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[1] * x.[2] // [(Chiral (L A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[2] * x.[1] // [(Chiral (R A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[2] * x.[2] // [(Chiral (R A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[2] * x.[2] // [(Chiral (R A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[1] * x.[2] // [(Chiral (L A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[2] * x.[1] // [(Chiral (R A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[2] * x.[6] // [(Chiral (R A01), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[2] * x.[5] // [(Chiral (R A01), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[2] * x.[4] // [(Chiral (R A01), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[2] * x.[3] // [(Chiral (R A01), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
            |]
            |> Array.fold (fun acc r -> acc + r) 0.0

            // PeptideChain (Peptide [L A01; L A01])
            [|
                -1.0 * x.[0] * x.[3] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                1.0 * x.[0] * x.[3] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[0] * x.[3] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                1.0 * x.[0] * x.[3] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                1.0 * x.[1] * x.[1] // [(Chiral (L A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[1] * x.[3] // [(Chiral (L A01), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[2] * x.[3] // [(Chiral (R A01), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[3] * x.[3] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[3] * x.[3] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[3] * x.[4] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[3] * x.[5] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[3] * x.[6] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[6] * x.[3] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[5] * x.[3] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
            |]
            |> Array.fold (fun acc r -> acc + r) 0.0

            // PeptideChain (Peptide [L A01; R A01])
            [|
                -1.0 * x.[0] * x.[4] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                1.0 * x.[0] * x.[4] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[0] * x.[4] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                1.0 * x.[0] * x.[4] // [(Food FoodSubst, 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                1.0 * x.[1] * x.[2] // [(Chiral (L A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[1] * x.[4] // [(Chiral (L A01), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[2] * x.[4] // [(Chiral (R A01), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[3] * x.[4] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[6] * x.[4] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[4] * x.[4] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[4] * x.[4] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[4] * x.[5] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[5] * x.[4] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[4] * x.[6] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
            |]
            |> Array.fold (fun acc r -> acc + r) 0.0

            // PeptideChain (Peptide [R A01; L A01])
            [|
                -1.0 * x.[0] * x.[5] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                1.0 * x.[0] * x.[5] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[0] * x.[5] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                1.0 * x.[0] * x.[5] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                1.0 * x.[2] * x.[1] // [(Chiral (R A01), 1); (Chiral (L A01), 1)]
                -1.0 * x.[2] * x.[5] // [(Chiral (R A01), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[1] * x.[5] // [(Chiral (L A01), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[6] * x.[5] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[3] * x.[5] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[5] * x.[5] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[5] * x.[5] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[4] * x.[5] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[5] * x.[4] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[5] * x.[3] // [(PeptideChain (Peptide [R A01; L A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
            |]
            |> Array.fold (fun acc r -> acc + r) 0.0

            // PeptideChain (Peptide [R A01; R A01])
            [|
                -1.0 * x.[0] * x.[6] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                1.0 * x.[0] * x.[6] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[0] * x.[6] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                1.0 * x.[0] * x.[6] // [(Food FoodSubst, 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                1.0 * x.[2] * x.[2] // [(Chiral (R A01), 1); (Chiral (R A01), 1)]
                -1.0 * x.[2] * x.[6] // [(Chiral (R A01), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[1] * x.[6] // [(Chiral (L A01), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[6] * x.[6] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[6] * x.[6] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[6] * x.[5] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [R A01; L A01]), 1)]
                -1.0 * x.[6] * x.[4] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [L A01; R A01]), 1)]
                -1.0 * x.[3] * x.[6] // [(PeptideChain (Peptide [L A01; L A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
                -1.0 * x.[6] * x.[3] // [(PeptideChain (Peptide [R A01; R A01]), 1); (PeptideChain (Peptide [L A01; L A01]), 1)]
                -1.0 * x.[4] * x.[6] // [(PeptideChain (Peptide [L A01; R A01]), 1); (PeptideChain (Peptide [R A01; R A01]), 1)]
            |]
            |> Array.fold (fun acc r -> acc + r) 0.0
        |]
